clear all
close all
clc

%  analyze Q's and ER's
analyzeQandER = 1;

% list of directories. analyze scanline in wetTest/x/Scan1.mat
dirList = {...
'\\pandora.bioeng.washington.edu\BioBenchData\EB\436Q2L\A\TMBraggBio_L134_4_corr110_period448_14_73\WetTest\2014.04.24@17.30\',...
'\\pandora.bioeng.washington.edu\BioBenchData\EB\436Q2L\A\TMBraggBio_L134_4_corr180_period448_16_72\WetTest\2014.04.24@17.30\',...
'\\pandora.bioeng.washington.edu\BioBenchData\EB\436Q2L\A\TMBraggBio_L179_2_corr110_period448_18_71\WetTest\2014.04.24@17.30\',...
'\\pandora.bioeng.washington.edu\BioBenchData\EB\436Q2L\A\TMBraggBio_L179_2_corr180_period448_20_69\WetTest\2014.04.24@17.30\',...
'\\pandora.bioeng.washington.edu\BioBenchData\EB\436Q2L\A\TMBraggBio_L268_8_corr110_period448_22_45\WetTest\2014.04.24@17.30\',...
'\\pandora.bioeng.washington.edu\BioBenchData\EB\436Q2L\A\TMBraggBio_L268_8_corr180_period448_24_58\WetTest\2014.04.24@17.30\',...
'\\pandora.bioeng.washington.edu\BioBenchData\EB\436Q2L\A\TMBraggBio_L358_4_corr110_period448_26_53\WetTest\2014.04.24@17.30\',...
'\\pandora.bioeng.washington.edu\BioBenchData\EB\436Q2L\A\TMBraggBio_L358_4_corr180_period448_28_49\WetTest\2014.04.24@17.30\',...
'\\pandora.bioeng.washington.edu\BioBenchData\EB\436Q2L\A\TMBraggBio_L44_8_corr110_period448_2_83\WetTest\2014.04.24@17.30\',...
'\\pandora.bioeng.washington.edu\BioBenchData\EB\436Q2L\A\TMBraggBio_L44_8_corr180_period448_4_82\WetTest\2014.04.24@17.30\',...
'\\pandora.bioeng.washington.edu\BioBenchData\EB\436Q2L\A\TMBraggBio_L537_6_corr110_period448_30_57\WetTest\2014.04.24@17.30\',...
'\\pandora.bioeng.washington.edu\BioBenchData\EB\436Q2L\A\TMBraggBio_L537_6_corr180_period448_32_56\WetTest\2014.04.24@17.30\',...
'\\pandora.bioeng.washington.edu\BioBenchData\EB\436Q2L\A\TMBraggBio_L71_68_corr110_period448_6_74\WetTest\2014.04.24@17.30\',...
'\\pandora.bioeng.washington.edu\BioBenchData\EB\436Q2L\A\TMBraggBio_L71_68_corr180_period448_8_78\WetTest\2014.04.24@17.30\',...
'\\pandora.bioeng.washington.edu\BioBenchData\EB\436Q2L\A\TMBraggBio_L89_6_corr110_period448_10_77\WetTest\2014.04.24@17.30\',...
'\\pandora.bioeng.washington.edu\BioBenchData\EB\436Q2L\A\TMBraggBio_L89_6_corr180_period448_12_75\WetTest\2014.04.24@17.30\'};

%% loop through all files and analyze
if analyzeQandER
    for ii = 1:length(dirList)
        [Q,ER,info] = Q_ER_Estimation(dirList{ii});
    end
end

%% publish
% dialog to ask user if they want to publish
outputFormat = 'pdf';
parentPath = '\\pandora.bioeng.washington.edu\BioBenchData\EB\436Q2L\A\';
option = struct(...
    'format', outputFormat, ...
    'outputDir', parentPath, ...
    'showCode', false, ...
    'codeToEvaluate', 'Q_ER_Estimation(dirList)');
publish('Q_ER_Reporting.m', option);

outputFile = strcat(parentPath, 'Q_ER_Reporting.', outputFormat);
renameFile = strcat(parentPath, 'QandER.', outputFormat);
movefile(outputFile, renameFile, 'f');

close all
